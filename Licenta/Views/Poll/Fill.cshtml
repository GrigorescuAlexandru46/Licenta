@model Licenta.Models.Poll

@{
    ViewBag.Title = Model.Name;
    int i = 1;
    int j = 1;
}

@if (ViewBag.Message != null)
{
    <div class="alert alert-dismissible alert-warning">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <p>@ViewBag.Message</p>
    </div>
}

<script>
    window.onload = function () {
        var navBar = document.getElementById("navBarTopMenu");
        navBar.parentNode.removeChild(navBar);

        var bodyContainer = document.getElementById("bodyId");
        bodyContainer.classList.add("border");
        bodyContainer.classList.add("rounded");
        bodyContainer.classList.add("px-5");
        bodyContainer.style.backgroundColor = "lightcyan";
    }
</script>

@using (Html.BeginForm("Fill", "Poll", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    @Html.Hidden("QuestionCount", Model.Questions.Count)
    foreach (var question in Model.Questions)
    {
        <div class="card bg-light mb-5">
            <div class="card-header"></div>
            <div class="card-body">
                @Html.Hidden("Question" + i + "_AnswerCount", Model.Questions.ElementAt(i - 1).Answers.Count)
                @Html.Hidden("Question" + i + "_Type", Model.Questions.ElementAt(i - 1).QuestionType)
                <div class="row">
                    <div class="col-lg-12">
                        <h4>@i. <span>&nbsp;</span> @question.Text</h4>
                    </div>
                </div>

                @{ j = 1; }

                @if (Model.Questions.ElementAt(i - 1).QuestionType != 3)
                {
                    <div class="col-lg-12">
                        @if (Model.Questions.ElementAt(i - 1).QuestionType == 1)
                        {
                            <h6>Choose a single answer</h6>
                        }
                        else if (Model.Questions.ElementAt(i - 1).QuestionType == 2)
                        {
                            <h6>Choose one or more answers</h6>
                        }
                    </div>

                    foreach (var answer in question.Answers)
                    {
                        @Html.Hidden("Question" + i + "_Answer" + j + "_Id", Model.Questions.ElementAt(i - 1).Answers.ElementAt(j - 1).AnswerId)
                        @Html.Hidden("Question" + i + "_Answer" + j + "_Text", Model.Questions.ElementAt(i - 1).Answers.ElementAt(j - 1).Text)

                        if (Model.Questions.ElementAt(i - 1).QuestionType == 1)
                        {
                            <div class="row">
                                <div class="col-lg-11 col-lg-offset-1">
                                    @Html.RadioButton("Question" + i + "_Answer", answer.Text)
                                    <label><span>&nbsp;&nbsp;</span>@answer.Text</label>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="row">
                                <div class="col-lg-11 col-lg-offset-1">
                                    <input type="checkbox" name="@("Question" + i + "_Answer" + j + "_Checkbox")" />
                                    <label><span>&nbsp;&nbsp;</span>@answer.Text</label>
                                </div>
                            </div>
                        }
                        
                        j++;
                    }
                }
                else
                {
                    @Html.Hidden("Question" + i + "_Answer_Id", Model.Questions.ElementAt(i - 1).Answers.ElementAt(0).AnswerId)
                    @Html.Hidden("Question" + i + "_Answer_Text", Model.Questions.ElementAt(i - 1).Answers.ElementAt(0).Text)

                    <div class="row">
                        <div class="col-lg-12">
                            <textarea class="form-control" name="@("Question" + i + "_CustomAnswer")" placeholder="Type your answer here" rows="1" style="max-width: 100%; width: 24%; min-height: 42px"></textarea>
                        </div>
                    </div>
                }

            </div>
        </div>
        i++;
    }

    <div class="row">
        <div class="col-md-3 col-md-offset-4">
            <input type="submit" class="btn btn-info btn-block" value="Submit" />
        </div>
    </div>

    @Html.Hidden("PollId", Model.PollId)
    @Html.Hidden("Name", Model.Name)
    @Html.Hidden("OwnerId", Model.OwnerId)
    @Html.Hidden("CreationDate", Model.CreationDate)
}


